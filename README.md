# DynamicPricing
Исследование различных вариантов алгоритма многоруких бандитов, эксперименты на реальных данных, оценка результаты.

# Работа с репозиторием:

## Как предсказать цену:

1. Привести данные к нужному формату: описан в работе, преобразовать, используя функции из `main/utils/data_preprocess.py`

2. Перейти к пункту 3, описанному ниже.


## Как обучить на новых данных:

### 1. Обучение модели предсказания первичной цены: 

Нужно обновить параметры в файле:

    data_path - путь к данным в формате csv
    n         - размер обучающей выборки

Далее запустить обучение следующим образом:

`python ./main/models/model_start_price.py`

Веса моделей будут сохранены в папку: `main/models/model_start_price.py`

Изображение с диограммой о рейтинге весомости признаков: `main/pictures/features_importance_start_price.png`


### 2. Обучение модели предсказания спроса: 
Нужно обновить параметры в файле:

    data_path - путь к данным в формате csv
    n         - размер обучающей выборки

Далее запустить обучение следующим образом:

`python ./main/models/model_demand.py`

Веса модели будут сохранены `main/models/model_demand.py`
Изображение с диограммой о рейтинге весомости признаков: `main/pictures/features_importance_demand.png`

### 3. Обучение бандитов:

Во всех файлах нужно задать параметры:

    data_path          - путь к данным в формате csv
    start_index        - индекс начала данных в файле
    m                  - количество ручек
    n                  - количество квартир
    start_dispersion   - для генерации ручек
    selling_treshold   - количество просмотров, на которое прихоодится одна покупка
    T                  - количество шагов алгоритма

Далее нужно выбрать один из алгоритмов: 

* `python ./main/run_bandit_e_greedy.py` - реализация epsilon-жадного алгоритма
    В нем нужно дополнительно задать параметр: epsilon  

* `python ./main/run_bandit_bernulli.py` - реализация томпсоновского сэмплирования для распределения Бернулли

* `python ./main/run_bandit_gauss.py` - реализация томпсоновского сэмплирования для нормального распределения

После завершения работы алгоритма в папке `main/pictures` можно будет увидеть графики по результатам обучения, 
а в `main/logs` будут сохранены предсказанные цены.



Функции для предобработки и визуализации данных можно найти в `main/utils`
